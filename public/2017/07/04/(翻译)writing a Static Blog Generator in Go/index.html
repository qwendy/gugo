<html>

<head>
    <title>(ç¿»è¯‘)writing a Static Blog Generator in Go</title>
</head>

<body>
    <div>(ç¿»è¯‘)writing a Static Blog Generator in Go</div>
    <div>2017-07-04 11:06:08</div>
    <div><p>ç¿»è¯‘åŸæ–‡ï¼š<a href="https://zupzup.org/static-blog-generator-go/?utm_source=golangweekly&amp;utm_medium=emai">https://zupzup.org/static-blog-generator-go/?utm_source=golangweekly&amp;utm_medium=emai</a></p>

<h1>Writing a Static Blog Generator in Go ä½¿ç”¨Goå†™ä¸€ä¸ªé™æ€åšå®¢ç”Ÿæˆå™¨</h1>

<p>A static-site-generator is a tool which, given some input (e.g. markdown) generates a fully static website using HTML, CSS and JavaScript.</p>

<p>ä¸€ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªä½¿ç”¨HTML, CSS and JavaScript,å°†ç»™äºˆçš„è¾“å…¥æ–‡ä»¶ï¼ˆä¾‹å¦‚markdownï¼‰ç”Ÿæˆå®Œæ•´çš„é™æ€ç½‘ç«™</p>

<p>Why is this cool? Well, for one itâ€™s a lot easier to host a static site and itâ€™s also (usually) quite a bit faster and resource-friendly. Static sites arenâ€™t the best choice for all use-cases, but for mostly non-interactive websites such as blogs they are great.</p>

<p>ä¸ºä»€ä¹ˆè¿™å¾ˆCoolï¼Ÿæ˜¯çš„ï¼Œå¯¹äºä¸€ä¸ªäººæ¥è¯´ï¼Œä¸»æŒä¸€ä¸ªé™æ€çš„ç½‘ç«™è¦å®¹æ˜“å¾—å¤šï¼Œè€Œä¸”(é€šå¸¸)ä¹Ÿä¼šæ›´å¿«ï¼Œè€Œä¸”èµ„æºæ›´å‹å¥½ã€‚é™æ€ç½‘ç«™ä¸æ˜¯å¯¹æ‰€æœ‰æƒ…å†µéƒ½æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯å¯¹äºå¤§å¤šæ•°éäº¤äº’ç½‘ç«™æ¯”å¦‚åšå®¢ï¼Œæ˜¯éå¸¸å¥½çš„ã€‚</p>

<p>In this post, I will describe the static blog generator I wrote in Go, which powers this blog.</p>

<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æè¿°æˆ‘ä½¿ç”¨Goç¼–å†™çš„é™æ€åšå®¢ç”Ÿæˆå™¨ï¼Œå®ƒä¸ºè¿™ä¸ªåšå®¢æä¾›äº†å¼ºå¤§çš„åŠŸèƒ½ã€‚</p>

<h2>Motivation åŠ¨æœº</h2>

<p>You might be familiar with static-site-generators like the great Hugo, which has just about all the features one could hope for in regards to static site generation.</p>

<p>ä½ å¯èƒ½å¯¹åƒHugoè¿™æ ·çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨å¾ˆç†Ÿæ‚‰ï¼Œå®ƒæ‹¥æœ‰å…³äºé™æ€ç«™ç‚¹ç”Ÿæˆçš„æ‰€æœ‰ç‰¹æ€§ã€‚</p>

<p>So why would I write another tool just like it with fewer capabilities? The reason was twofold.</p>

<p>æ‰€ä»¥æˆ‘ä¸ºä»€ä¹ˆå†™å¦å¤–ä¸€ä¸ªåƒå®ƒä¸€æ ·ä½†åŠŸèƒ½æ›´å°‘çš„å·¥å…·ï¼ŸåŸå› æœ‰ä¸¤ä¸ªã€‚</p>

<p>One reason was that I wanted to dive deeper into Go and a command-line-based static-site-generator seemed like a great playground to hone my skills.</p>

<p>ä¸€ä¸ªåŸå› æ˜¯æˆ‘æƒ³è¦æ·±å…¥å­¦ä¹ Goï¼Œä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„é™æ€åšå®¢ç”Ÿæˆå™¨ä¼¼ä¹æ˜¯ä¸€ä¸ªç£¨ç»ƒæˆ‘æŠ€èƒ½çš„å¥½åœ°æ–¹ã€‚</p>

<p>The second reason was simply that I had never done it before. Iâ€™ve done my fair share of web-development, but I never created a static-site-generator.</p>

<p>ç¬¬äºŒä¸ªåŸå› æ˜¯ï¼Œæˆ‘ä»¥å‰ä»æœªåšè¿‡è¿™ä¸ªã€‚æˆ‘åšè¿‡æˆ‘çš„webå¼€å‘çš„åˆ†äº«ï¼Œä½†æˆ‘ä»æœªåˆ›å»ºè¿‡é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ã€‚</p>

<p>This made it intriguing because I theoretically had all the prerequisites and skills to build such a tool with my background in web-development, but I had never tried doing it.</p>

<p>è¿™å¾ˆæœ‰è¶£ï¼Œå› ä¸ºæˆ‘åœ¨ç†è®ºä¸Šå…·å¤‡äº†åœ¨webå¼€å‘èƒŒæ™¯ä¸‹æ„å»ºè¿™æ ·ä¸€ä¸ªå·¥å…·çš„æ‰€æœ‰å…ˆå†³æ¡ä»¶å’ŒæŠ€èƒ½ï¼Œä½†æˆ‘ä»æœªå°è¯•è¿‡è¿™æ ·åšã€‚</p>

<p>I was hooked, implemented it within about 2 weeks and had a great time doing it. I used my blog-generator for creating this blog and it worked great so far. :)</p>

<p>æˆ‘è¢«è¿·ä½äº†ï¼Œåœ¨å¤§çº¦ä¸¤å‘¨çš„æ—¶é—´å†…å®ç°äº†å®ƒï¼Œåœ¨å®ç°çš„æ—¶å€™æˆ‘å¾ˆé«˜å…´ã€‚æˆ‘ç”¨æˆ‘çš„åšå®¢ç”Ÿæˆå™¨åˆ›å»ºäº†è¿™ä¸ªåšå®¢ï¼Œåˆ°ç›®å‰ä¸ºæ­¢æ•ˆæœå¾ˆå¥½ã€‚:)</p>

<h2>Concept æ¦‚å¿µ</h2>

<p>Early on, I decided to write my blog posts in markdown and keep them in a GitHub Repo. The posts are structured in folders, which represent the url of the blog post.</p>

<p>æ—©äº›æ—¶å€™ï¼Œæˆ‘å†³å®šä½¿ç”¨markdownå†™æˆ‘çš„åšå®¢æ–‡ç« ï¼Œå¹¶å°†ä»–ä»¬æ”¾åœ¨githubçš„ä»“åº“ï¼ˆrepoï¼‰ä¸­ã€‚æ–‡ç« ä»¥æ–‡ä»¶å¤¹ä¸ºç»“æ„ï¼Œä»£è¡¨äº†åšå®¢æ–‡ç« çš„url</p>

<p>For metadata, such as publication date, tags, title and subtitle I decided on keeping a meta.yml file with each post.md file with the following format:</p>

<p>è‡³äºmetadataï¼Œä¾‹å¦‚å‘å¸ƒæ—¥æœŸï¼Œæ ‡ç­¾ï¼Œæ ‡é¢˜å’Œå‰¯æ ‡é¢˜ï¼Œæˆ‘å†³å®šä½¿ç”¨meta.ymlï¼Œæ¯ä¸ªå¸–å­éƒ½æœ‰ä»¥ä¸‹çš„æ ¼å¼ï¼š</p>

<pre><code>title: Playing Around with BoltDB 
short: &#34;Looking for a simple key/value store for your Go applications? Look no further!&#34;
date: 20.04.2017
tags:
    - golang
    - go
    - boltdb
    - bolt
</code></pre>

<p>This allowed me to separate the content from the metadata, but still keep everything in the same place, where Iâ€™d find it later.</p>

<p>è¿™å…è®¸æˆ‘åis allowed me to separate the content from the metadata, but still keep everything in the same place, where Iâ€™d find it later.</p>

<p>è¿™å…è®¸æˆ‘å°†å†…å®¹ä»metadataä¸­åˆ†ç¦»ï¼Œä½†æ˜¯éœ€è¦å°†æ‰€æœ‰ä¸œè¥¿æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œè®©æˆ‘èƒ½å¾…ä¼šå„¿èƒ½æ‰¾åˆ°å®ƒã€‚</p>

<p>The GitHub Repo was my data source. The next step was to think about features and I came up with this List:</p>

<p>github repoæ˜¯æˆ‘çš„æ•°æ®æ¥æºã€‚ä¸‹ä¸€æ­¥æ˜¯è€ƒè™‘ç‰¹æ€§ï¼Œæˆ‘æƒ³åˆ°äº†ä»¥ä¸‹å†…å®¹ï¼š</p>

<ul>
<li>Very Lean (landing page should be 1 Request &lt; 10K gzipped)éå¸¸è½»é‡ã€‚ï¼ˆç™»å½•é¡µé¢åº”è¯¥1ä¸ªè¯·æ±‚å°äº10kï¼‰</li>
<li>Listing for the landing page and an Archive å±•ç¤º</li>
<li>Possibility to use syntax-highlighted Code and Images within Blog Posts åœ¨æ–‡ç« ä¸­èƒ½å¤Ÿä½¿ç”¨è¯­æ³•é«˜äº®ä»£ç ï¼Œå›¾ç‰‡</li>
<li>Tags æ ‡ç­¾</li>
<li>RSS feed (index.xml) RSSè®¢é˜…</li>
<li>Optional Static Pages (e.g. About) å¯é€‰çš„é™æ€é¡µé¢ï¼ˆä¾‹å¦‚ï¼šAboutï¼‰</li>
<li>High Maintainability - use the least amount of templates possible é«˜å¯ç»´æŠ¤æ€§-ä½¿å°½å¯èƒ½å°‘çš„æ¨¡æ¿</li>
<li>sitemap.xml for SEO ç”¨äºSEOçš„sitemap.xml</li>
<li>Local preview of the whole blog (a simple run.sh script)æœ¬åœ°çš„æ•´ä¸ªåšå®¢çš„é¢„è§ˆ(ç®€å•çš„run.shè„šæœ¬)</li>
</ul>

<p>Quite a healthy feature set. What was very important for me from the start, was to keep everything simple, fast and clean - without any third-party trackers or ads, which compromise privacy and slow everything down.</p>

<p>ç›¸å½“å¥å£®çš„ç‰¹æ€§é›†.å¯¹æˆ‘æ¥è¯´æœ€å¼€å§‹æœ€é‡è¦çš„ï¼Œæ˜¯ä¿æŒæ‰€æœ‰çš„ä¸œè¥¿éƒ½è¦ç®€å•ï¼Œå¿«é€Ÿå’Œå¹²å‡€ â€“ æ²¡æœ‰ä»»ä½•ç¬¬ä¸‰æ–¹çš„è·Ÿè¸ªå™¨å’Œå¹¿å‘Šï¼Œä¿è¯éšç§å’Œä½¿æ‰€æœ‰äº‹æƒ…éƒ½æ”¾ç¼“ã€‚</p>

<p>Based on these ideas, I started making a rough plan of the architecture and started coding.</p>

<p>åŸºäºè¿™äº›æƒ³æ³•ï¼Œæˆ‘å¼€å§‹å¯¹æ¶æ„è¿›è¡Œç²—ç•¥çš„è§„åˆ’ï¼Œå¹¶å¼€å§‹ç¼–å†™ä»£ç ã€‚</p>

<h2>Architectural Overview æ¶æ„æ¦‚è¿°</h2>

<p>The application is simple enough. The high-level elements are:</p>

<p>ç¨‹åºè¶³å¤Ÿç®€å•ã€‚é«˜ç­‰çº§çš„å…ƒç´ å¦‚ä¸‹ï¼š</p>

<ul>
<li>CLI å‘½ä»¤è¡Œç•Œé¢</li>
<li>DataSource æ•°æ®æº</li>
<li>Generators ç”Ÿæˆå™¨</li>
</ul>

<p>The CLI in this case is very simple, as I didnâ€™t add any features in terms of configurability. It basically just fetches data from the DataSource and runs the Generators on it.</p>

<p>åœ¨è¿™é‡ŒCLIéå¸¸ç®€å•ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰åœ¨å¯é…ç½®æ€§æ–¹é¢æ·»åŠ ä»»ä½•ç‰¹æ€§ã€‚ä»…ä»…æ˜¯ä»DataSourceä¸­è·å–æ•°æ® ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆå™¨è¿è¡Œå®ƒã€‚</p>

<p>The DataSource interface looks like this:</p>

<p>DotaSourceæ¥å£é•¿è¿™æ ·ï¼š</p>

<pre><span class="kwd">type</span> <span class="typ">DataSource</span> <span class="kwd">interface</span> <span class="pun">{</span>
    <span class="typ">Fetch</span><span class="pun">(</span><span class="kwd">from</span><span class="pun">,</span> <span class="pln">to</span> <span class="pln">string</span><span class="pun">)</span> <span class="pun">(</span><span class="pun">[</span><span class="pun">]</span><span class="pln">string</span><span class="pun">,</span> <span class="pln">error</span><span class="pun">)</span>
<span class="pun">}</span>
</pre>

<p>The Generator interface looks like this:
ç”Ÿæˆå™¨æ¥å£é•¿è¿™æ ·ï¼š</p>

<pre><span class="kwd">type</span> <span class="typ">Generator</span> <span class="kwd">interface</span> <span class="pun">{</span>
    <span class="typ">Generate</span><span class="pun">(</span><span class="pun">)</span> <span class="pln">error</span>
<span class="pun">}</span>
</pre>

<p>Pretty simple. Each Generator also receives a configuration struct, which contains all the necessary data for generation.</p>

<p>ç›¸å½“ç®€å•ã€‚æ¯ä¸€ä¸ªç”Ÿæˆå™¨éƒ½æ¥å—ä¸€ä¸ªé…ç½®çš„ç»“æ„ä½“ï¼ŒåŒ…å«äº†æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯ã€‚</p>

<p>There are 7 Generators at the time of writing this post:</p>

<p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæœ‰äº†7ä¸ªç”Ÿæˆå™¨ã€‚</p>

<ul>
<li>SiteGenerator</li>
<li>ListingGenerator</li>
<li>PostGenerator</li>
<li>RSSGenerator</li>
<li>SitemapGenerator</li>
<li>StaticsGenerator</li>
<li>TagsGenerator
Where the SiteGenerator is the meta-generator, which calls all other generators and outputs the whole static website.</li>
</ul>

<p>SiteGeneratoræ˜¯meta-generatorè°ƒç”¨å…¶ä»–æ‰€æœ‰çš„ç”Ÿæˆå™¨å¹¶è¾“å‡ºæ•´ä¸ªé™æ€ç½‘ç«™çš„åœ°æ–¹ã€‚</p>

<p>The generation is based on HTML templates using Goâ€™s html/template package.</p>

<p>ç”Ÿæˆå™¨åŸºäºHTMLæ¨¡æ¿ï¼Œä½¿ç”¨Goçš„html/template package.</p>

<h2>Implementation Details å®ç°ç»†èŠ‚</h2>

<p>In this section I will just cover a few selected parts I think might be interesting, such as the git DataSource and the different Generators.</p>

<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†ä»‹ç»ä¸€äº›æˆ‘è®¤ä¸ºå¯èƒ½å¾ˆæœ‰è¶£çš„éƒ¨åˆ†ï¼Œå¦‚gitæ•°æ®æºå’Œä¸åŒçš„ç”Ÿæˆå™¨ã€‚</p>

<h3>DataSource</h3>

<p>First up, we need some data to generate our blog from. This data, as mentioned above has the form of a git repository. The following Fetch function captures most of what the DataSource implementation does:</p>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ•°æ®æ¥ç”Ÿæˆæˆ‘ä»¬çš„åšå®¢ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™äº›æ•°æ®å…·æœ‰gitå­˜å‚¨åº“çš„å½¢å¼ã€‚ä¸‹é¢çš„Fetchå‡½æ•°å±•ç¤ºäº†å¤§å¤šæ•°æ•°æ®æºå®ç°çš„åŠŸèƒ½:</p>

<pre><span class="kwd">func</span> <span class="pun">(</span><span class="pln">ds</span> <span class="pun">*</span><span class="typ">GitDataSource</span><span class="pun">)</span> <span class="typ">Fetch</span><span class="pun">(</span><span class="kwd">from</span><span class="pun">,</span> <span class="pln">to</span> <span class="pln">string</span><span class="pun">)</span> <span class="pun">(</span><span class="pun">[</span><span class="pun">]</span><span class="pln">string</span><span class="pun">,</span> <span class="pln">error</span><span class="pun">)</span> <span class="pun">{</span>
    <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Printf</span><span class="pun">(</span><span class="str">&#34;Fetching data from %s into %s...\n&#34;</span><span class="pun">,</span> <span class="kwd">from</span><span class="pun">,</span> <span class="pln">to</span><span class="pun">)</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">createFolderIfNotExist</span><span class="pun">(</span><span class="pln">to</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
        <span class="kwd">return</span> <span class="kwd">nil</span><span class="pun">,</span> <span class="pln">err</span>
    <span class="pun">}</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">clearFolder</span><span class="pun">(</span><span class="pln">to</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
        <span class="kwd">return</span> <span class="kwd">nil</span><span class="pun">,</span> <span class="pln">err</span>
    <span class="pun">}</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">cloneRepo</span><span class="pun">(</span><span class="pln">to</span><span class="pun">,</span> <span class="kwd">from</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
        <span class="kwd">return</span> <span class="kwd">nil</span><span class="pun">,</span> <span class="pln">err</span>
    <span class="pun">}</span>
    <span class="pln">dirs</span><span class="pun">,</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">getContentFolders</span><span class="pun">(</span><span class="pln">to</span><span class="pun">)</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
        <span class="kwd">return</span> <span class="kwd">nil</span><span class="pun">,</span> <span class="pln">err</span>
    <span class="pun">}</span>
    <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Print</span><span class="pun">(</span><span class="str">&#34;Fetching complete.\n&#34;</span><span class="pun">)</span>
    <span class="kwd">return</span> <span class="pln">dirs</span><span class="pun">,</span> <span class="kwd">nil</span>
<span class="pun">}</span>
</pre>

<p>Fetch is called with two parameters from, which is a repository URL and to, which is the destination folder. The function creates and clears the destination folder, clones the repository using os/exec plus a git command and finally reads the folder, returning a list of paths for all the files within the repository.</p>

<p>Fetchä½¿ç”¨2ä¸ªå‚æ•°æ¥è°ƒç”¨ï¼Œä¸€ä¸ªæ˜¯repoçš„url ï¼Œä¸€ä¸ªæ˜¯ç›®æ ‡çš„æ–‡ä»¶å¤¹ã€‚è¿™ä¸ªå‡½æ•°åˆ›å»ºå¹¶æ¸…é™¤ç›®æ ‡æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨os/execæ·»åŠ ä¸€ä¸ªgitå‘½ä»¤å…‹éš†repoï¼Œæœ€åè¯»å–æ–‡ä»¶å¤¹ï¼Œè¿”å›repoä¸­çš„æ‰€æœ‰æ–‡ä»¶çš„è·¯å¾„åˆ—è¡¨</p>

<p>As mentioned above, the repository contains only folders, which represent the different blog posts. The array with these folder paths is then passed to the generators, which can then do their thing for each of the blog posts within the repository.</p>

<p>å¦‚ä¸Šæ‰€è¯´ï¼Œè¿™ä¸ªrepoä»…ä»…åŒ…å«æ–‡ä»¶å¤¹ï¼Œä»£è¡¨ç€ä¸åŒåšå®¢çš„æ–‡ç« ã€‚å°†è¿™äº›æ–‡ä»¶å¤¹è·¯å¾„çš„æ•°æ®ä¼ é€’ç»™ç”Ÿæˆå™¨ï¼Œ</p>

<h3>Kicking it all off å¼€å§‹å®Œæˆæ‰€æœ‰çš„ç›®æ ‡</h3>

<p>After the Fetch comes the Generate phase. When the blog-generator is executed, the following code is executed on the highest level:</p>

<p>åœ¨Fetchä¹‹åï¼Œæ¥ä¸‹æ¥æ˜¯Generateé˜¶æ®µã€‚å½“blog-generatoræ‰§è¡Œçš„æ—¶å€™ï¼Œä¸‹é¢çš„ä»£ç ä¼šæœ€å…ˆæ‰§è¡Œã€‚</p>

<pre><span class="pln">ds</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">datasource</span><span class="pun">.</span><span class="typ">New</span><span class="pun">(</span><span class="pun">)</span>
<span class="pln">dirs</span><span class="pun">,</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">ds</span><span class="pun">.</span><span class="typ">Fetch</span><span class="pun">(</span><span class="typ">RepoURL</span><span class="pun">,</span> <span class="typ">TmpFolder</span><span class="pun">)</span>
<span class="kwd">if</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
    <span class="pln">log</span><span class="pun">.</span><span class="typ">Fatal</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span>
<span class="pun">}</span>
<span class="pln">g</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">generator</span><span class="pun">.</span><span class="typ">New</span><span class="pun">(</span><span class="pun">&amp;</span><span class="pln">generator</span><span class="pun">.</span><span class="typ">SiteConfig</span><span class="pun">{</span>
    <span class="typ">Sources</span><span class="pun">:</span>     <span class="pln">dirs</span><span class="pun">,</span>
    <span class="typ">Destination</span><span class="pun">:</span> <span class="typ">DestFolder</span><span class="pun">,</span>
<span class="pun">}</span><span class="pun">)</span>
<span class="pln">err</span> <span class="pun">=</span> <span class="pln">g</span><span class="pun">.</span><span class="typ">Generate</span><span class="pun">(</span><span class="pun">)</span>
<span class="kwd">if</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
    <span class="pln">log</span><span class="pun">.</span><span class="typ">Fatal</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span>
<span class="pun">}</span>
</pre>

<p>The generator.New function creates a new SiteGenerator which is basically a generator, which calls other generators. Itâ€™s passed a destination folder and the directories for the blog posts within the repository.</p>

<p>generate.Newå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„SiteGenerateï¼ŒSiteGenerateæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç”Ÿæˆå™¨ï¼Œå®ƒè°ƒç”¨å…¶ä»–ç”Ÿæˆå™¨ã€‚éœ€è¦ä¼ é€’ç›®æ ‡æ–‡ä»¶å¤¹å’Œç”Ÿæˆåœ¨repoä¸­åšå®¢æ–‡ç« çš„ç›®å½•ã€‚</p>

<p>As every Generator implementing the interface mentioned above, the SiteGenerator has a Generate method, which returns an error. The Generate method of the SiteGenerator prepares the destination folder, reads in templates, prepares data structures for the blog posts, registers the other generators and concurrently runs them.</p>

<p>æ­£å¦‚ä¸Šé¢æåˆ°çš„æ¯ä¸€ä¸ªç”Ÿæˆå™¨æ¥å£çš„å®ç°ï¼ŒSiteGenerateæœ‰ä¸€ä¸ªè¿”å›errorçš„Generateæ–¹æ³•ã€‚SiteGenerateçš„Generateçš„æ–¹æ³•å‡†å¤‡äº†ç›®æ ‡æ–‡ä»¶å¤¹ï¼Œè¯»å–æ¨¡æ¿ï¼Œå‡†å¤‡åšå®¢æ–‡ç« çš„æ•°æ®ç»“æ„ï¼Œæ³¨å†Œå…¶ä»–ç”Ÿæˆå™¨å¹¶ä¸”å¹¶å‘æ‰§è¡Œä»–ä»¬ã€‚</p>

<p>The SiteGenerator also registers some settings for the blog like the URL, Language, Date Format etc. These settings are simply global constants, which is certainly not the prettiest solution or the most scalable, but itâ€™s simple and that was the highest goal here.</p>

<p>SiteGenerateåŒæ ·æ³¨å†Œäº†ä¸€äº›æ–‡ç« çš„è®¾ç½®ï¼Œä¾‹å¦‚URLï¼Œè¯­è¨€ï¼Œæ•°æ®æ ¼å¼ç­‰ç­‰ã€‚è¿™äº›è®¾ç½®æ˜¯ç®€å•çš„å…¨å±€å¸¸é‡ï¼Œè¿™å½“ç„¶ä¸æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•ä¹Ÿä¸æ˜¯æœ€æœ‰æ‰©å±•æ€§çš„ï¼Œä½†æ˜¯å®ƒå¾ˆç®€å•ï¼Œå¹¶ä¸”åœ¨è¿™é‡Œï¼Œè¿™æ˜¯æˆ‘ä»¬çš„æœ€é«˜ç›®æ ‡ã€‚</p>

<h3>Posts</h3>

<p>The most important concept on a blog are - surprise, surprise - blog posts! In the context of this blog-generator, they are represented by the following data-structure:</p>

<p>åšå®¢æœ€é‡è¦çš„æ¦‚å¿µå°±æ˜¯åšå®¢çš„æ–‡ç« ã€‚åœ¨è¿™ä¸ªblog-ç”Ÿæˆå™¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒä»¬ç”±ä»¥ä¸‹æ•°æ®ç»“æ„è¡¨ç¤º:</p>

<pre><span class="kwd">type</span> <span class="typ">Post</span> <span class="kwd">struct</span> <span class="pun">{</span>
    <span class="typ">Name</span>      <span class="pln">string</span>
    <span class="typ">HTML</span>      <span class="pun">[</span><span class="pun">]</span><span class="kwd">byte</span>
    <span class="typ">Meta</span>      <span class="pun">*</span><span class="typ">Meta</span>
    <span class="typ">ImagesDir</span> <span class="pln">string</span>
    <span class="typ">Images</span>    <span class="pun">[</span><span class="pun">]</span><span class="pln">string</span>
<span class="pun">}</span>
</pre>

<p>These posts are created by iterating over the folders in the repository, reading the meta.yml file, converting the post.md file to HTML and by adding images, if there are any.</p>

<p>è¿™äº›æ–‡ç« æ˜¯é€šè¿‡åœ¨å­˜å‚¨åº“ä¸­çš„æ–‡ä»¶å¤¹ä¸­è¿­ä»£æ¥åˆ›å»ºçš„ï¼Œè¯»å–meta.ymlæ–‡ä»¶ï¼Œè½¬æ¢post.mdæ–‡ä»¶åˆ°HTMLï¼Œå¦‚æœæœ‰å›¾åƒçš„è¯æ·»åŠ å›¾åƒã€‚</p>

<p>Quite a bit of work, but once we have the posts represented as a data structure, the generation of posts is quite simple and looks like this:</p>

<p>åšäº†å¾ˆå¤šå·¥ä½œï¼Œä½†æ˜¯ä¸€æ—¦æˆ‘ä»¬çš„postè¢«è¡¨ç¤ºä¸ºæ•°æ®ç»“æ„ï¼Œæ–‡ç« çš„ç”Ÿæˆå°±å¾ˆç®€å•äº†ï¼Œçœ‹èµ·æ¥å°±åƒè¿™æ ·:</p>

<pre><span class="kwd">func</span> <span class="pun">(</span><span class="pln">g</span> <span class="pun">*</span><span class="typ">PostGenerator</span><span class="pun">)</span> <span class="typ">Generate</span><span class="pun">(</span><span class="pun">)</span> <span class="pln">error</span> <span class="pun">{</span>
    <span class="pln">post</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">g</span><span class="pun">.</span><span class="typ">Config</span><span class="pun">.</span><span class="typ">Post</span>
    <span class="pln">destination</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">g</span><span class="pun">.</span><span class="typ">Config</span><span class="pun">.</span><span class="typ">Destination</span>
    <span class="pln">t</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">g</span><span class="pun">.</span><span class="typ">Config</span><span class="pun">.</span><span class="typ">Template</span>
    <span class="pln">staticPath</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s%s&#34;</span><span class="pun">,</span> <span class="pln">destination</span><span class="pun">,</span> <span class="pln">post</span><span class="pun">.</span><span class="typ">Name</span><span class="pun">)</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">os</span><span class="pun">.</span><span class="typ">Mkdir</span><span class="pun">(</span><span class="pln">staticPath</span><span class="pun">,</span> <span class="pln">os</span><span class="pun">.</span><span class="typ">ModePerm</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
      <span class="kwd">return</span> <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Errorf</span><span class="pun">(</span><span class="str">&#34;error creating directory at %s: %v&#34;</span><span class="pun">,</span> <span class="pln">staticPath</span><span class="pun">,</span> <span class="pln">err</span><span class="pun">)</span>
    <span class="pun">}</span>
    <span class="kwd">if</span> <span class="pln">post</span><span class="pun">.</span><span class="typ">ImagesDir</span> <span class="pun">!</span><span class="pun">=</span> <span class="str">&#34;&#34;</span> <span class="pun">{</span>
      <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">copyImagesDir</span><span class="pun">(</span><span class="pln">post</span><span class="pun">.</span><span class="typ">ImagesDir</span><span class="pun">,</span> <span class="pln">staticPath</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
          <span class="kwd">return</span> <span class="pln">err</span>
      <span class="pun">}</span>
    <span class="pun">}</span>
    <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">writeIndexHTML</span><span class="pun">(</span><span class="pln">staticPath</span><span class="pun">,</span> <span class="pln">post</span><span class="pun">.</span><span class="typ">Meta</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">,</span> <span class="kwd">template</span><span class="pun">.</span><span class="typ">HTML</span><span class="pun">(</span><span class="pln">string</span><span class="pun">(</span><span class="pln">post</span><span class="pun">.</span><span class="typ">HTML</span><span class="pun">)</span><span class="pun">)</span><span class="pun">,</span> <span class="pln">t</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
      <span class="kwd">return</span> <span class="pln">err</span>
    <span class="pun">}</span>
    <span class="kwd">return</span> <span class="kwd">nil</span>
<span class="pun">}</span>
</pre>

<p>First, we create a directory for the post, then we copy the images in there and finally create the postâ€™s index.html file using templating. The PostGenerator also implements syntax-highlighting, which I described in this post.</p>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™poståˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç„¶åå¤åˆ¶å›¾ç‰‡åˆ°è¿™é‡Œï¼Œæœ€åä½¿ç”¨æ¨¡æ¿åˆ›å»ºpostçš„index.htmlã€‚æˆ‘åœ¨æœ¬æ–‡ä¸­è¯´äº†ï¼ŒPostGenerateå®ç°äº†è¯­æ³•é«˜äº®ã€‚</p>

<h3>Listing Creation æ¸…å•åˆ›å»º</h3>

<p>When a user comes to the landing page of the blog, she sees the latest posts with information like the reading time of the article and a short description. For this feature and for the archive, I implemented the ListingGenerator, which takes the following config:</p>

<p>å½“ä¸€ä¸ªç”¨æˆ·è®¿é—®åšå®¢ç™»å½•ç•Œé¢çš„æ—¶å€™ï¼Œå¥¹ä¼šçœ‹åˆ°æœ€è¿‘çš„æ–‡ç« çš„ä¿¡æ¯ï¼Œä¾‹å¦‚é˜…è¯»æ–‡ç« éœ€è¦çš„æ—¶é—´å’Œç®€å•çš„æè¿°ã€‚ä¸ºäº†è¿™ä¸ªç‰¹æ€§å¹¶ä¸”ä¸ºäº†å­˜æ¡£ï¼Œæˆ‘ä»¬å®ç°äº†ListingGeneratorï¼Œä½¿ç”¨äº†å¦‚ä¸‹çš„é…ç½®ï¼š</p>

<pre><span class="kwd">type</span> <span class="typ">ListingConfig</span> <span class="kwd">struct</span> <span class="pun">{</span>
    <span class="typ">Posts</span>                  <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span>
    <span class="typ">Template</span>               <span class="pun">*</span><span class="kwd">template</span><span class="pun">.</span><span class="typ">Template</span>
    <span class="typ">Destination</span><span class="pun">,</span> <span class="typ">PageTitle</span> <span class="pln">string</span>
<span class="pun">}</span>
</pre>

<p>The Generate method of this generator iterates over the post, assembles their metadata and creates short blocks based on the given template. Then these blocks are appended and written to the index template.</p>

<p>è¿™ä¸ªç”Ÿæˆå™¨çš„ç”Ÿæˆæ–¹æ³•åœ¨postä¸Šè¿­ä»£ï¼Œç»„è£…å®ƒä»¬çš„å…ƒæ•°æ®ï¼Œå¹¶æ ¹æ®ç»™å®šçš„æ¨¡æ¿åˆ›å»ºçŸ­å—ã€‚ç„¶åå°†è¿™äº›å—é™„åŠ åˆ°ç´¢å¼•æ¨¡æ¿ä¸­ã€‚</p>

<p>I liked mediumâ€™s feature to approximate the time to read an article, so I implemented my own version of it, based on the assumption that an average human reads about 200 words per minute. Images also count towards the overall reading time with a constant 12 seconds added for each img tag in the post. This will obviously not scale for arbitrary content, but should be a fine approximation for my usual articles:</p>

<p>æˆ‘å–œæ¬¢é˜…è¯»æ–‡ç« çš„è¿‘ä¼¼æ—¶é—´çš„åª’ä½“ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘å®ç°äº†è‡ªå·±çš„ç‰ˆæœ¬ã€‚å‡è®¾äººç±»å‡­å€Ÿæ¯åˆ†é’Ÿé˜…è¯»200ä¸ªå•è¯ã€‚å›¾ç‰‡åŒæ ·è®¡å…¥æ€»é˜…è¯»æ—¶é—´ï¼Œä»¥æ¯å¼ å›¾12ç§’è®¡ç®—ã€‚è¿™æ˜¾ç„¶ä¸é€‚åˆä»»æ„å†…å®¹ï¼Œä½†å¾ˆé€‚åˆæˆ‘çš„æ–‡ç« ã€‚</p>

<pre><span class="kwd">func</span> <span class="pln">calculateTimeToRead</span><span class="pun">(</span><span class="pln">input</span> <span class="pln">string</span><span class="pun">)</span> <span class="pln">string</span> <span class="pun">{</span>
    <span class="com">// an average human reads about 200 wpm</span>
    <span class="kwd">var</span> <span class="pln">secondsPerWord</span> <span class="pun">=</span> <span class="dec">60.0</span> <span class="pun">/</span> <span class="dec">200.0</span>
    <span class="com">// multiply with the amount of words</span>
    <span class="pln">words</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">secondsPerWord</span> <span class="pun">*</span> <span class="kwd">float64</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">strings</span><span class="pun">.</span><span class="typ">Split</span><span class="pun">(</span><span class="pln">input</span><span class="pun">,</span> <span class="str">&#34; &#34;</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span>
    <span class="com">// add 12 seconds for each image</span>
    <span class="pln">images</span> <span class="pun">:</span><span class="pun">=</span> <span class="dec">12.0</span> <span class="pun">*</span> <span class="pln">strings</span><span class="pun">.</span><span class="typ">Count</span><span class="pun">(</span><span class="pln">input</span><span class="pun">,</span> <span class="str">&#34;&lt;img&#34;</span><span class="pun">)</span>
    <span class="pln">result</span> <span class="pun">:</span><span class="pun">=</span> <span class="pun">(</span><span class="pln">words</span> <span class="pun">+</span> <span class="kwd">float64</span><span class="pun">(</span><span class="pln">images</span><span class="pun">)</span><span class="pun">)</span> <span class="pun">/</span> <span class="dec">60.0</span>
    <span class="kwd">if</span> <span class="pln">result</span> <span class="pun">&lt;</span> <span class="dec">1.0</span> <span class="pun">{</span>
        <span class="pln">result</span> <span class="pun">=</span> <span class="dec">1.0</span>
    <span class="pun">}</span>
    <span class="kwd">return</span> <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%.0fm&#34;</span><span class="pun">,</span> <span class="pln">result</span><span class="pun">)</span>
<span class="pun">}</span>
</pre>

<h3>Tags æ ‡ç­¾</h3>

<p>Next, to have a way to categorize and filter the posts by topic, I opted to implement a simple tagging mechanism. Posts have a list of tags in their meta.yml file. These tags should be listed on a separate Tags Page and upon clicking on a tag, the user is supposed to see a listing of posts with the selected tag.</p>

<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†åˆ†ç±»å’Œé€šè¿‡ä¸»é¢˜è¿‡æ»¤æ–‡ç« ï¼Œæˆ‘é€‰æ‹©å®ç°ä¸€ä¸ªç®€å•çš„æ ‡ç­¾æœºåˆ¶ã€‚æ–‡ç« åœ¨meta.ymlä¸­æœ‰æ ‡ç­¾åˆ—è¡¨ã€‚è¿™äº›æ ‡ç­¾åº”è¯¥åœ¨ç‹¬ç«‹çš„æ ‡ç­¾é¡µä¸­ï¼Œæ ¹æ®ç‚¹å‡»ä¸€ä¸ªæ ‡ç­¾ï¼Œç”¨æˆ·åº”è¯¥èƒ½çœ‹åˆ°è¿™ä¸ªæ ‡ç­¾çš„æ–‡ç« åˆ—è¡¨ã€‚</p>

<p>First up, we create a map from tag to Post:</p>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºæ ‡ç­¾åˆ°æ–‡ç« çš„æ˜ å°„è¡¨ã€‚</p>

<pre><span class="kwd">func</span> <span class="pln">createTagPostsMap</span><span class="pun">(</span><span class="pln">posts</span> <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span><span class="pun">)</span> <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span> <span class="pun">{</span>
<span class="pln">result</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">make</span><span class="pun">(</span><span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span><span class="pun">)</span>
    <span class="kwd">for</span> <span class="pln">_</span><span class="pun">,</span> <span class="pln">post</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">posts</span> <span class="pun">{</span>
        <span class="kwd">for</span> <span class="pln">_</span><span class="pun">,</span> <span class="pln">tag</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">post</span><span class="pun">.</span><span class="typ">Meta</span><span class="pun">.</span><span class="typ">Tags</span> <span class="pun">{</span>
            <span class="pln">key</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">strings</span><span class="pun">.</span><span class="typ">ToLower</span><span class="pun">(</span><span class="pln">tag</span><span class="pun">)</span>
             <span class="kwd">if</span> <span class="pln">result</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span> <span class="pun">=</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
                 <span class="pln">result</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span> <span class="pun">=</span> <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span><span class="pun">{</span><span class="pln">post</span><span class="pun">}</span>
             <span class="pun">}</span> <span class="kwd">else</span> <span class="pun">{</span>
                 <span class="pln">result</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span> <span class="pun">=</span> <span class="kwd">append</span><span class="pun">(</span><span class="pln">result</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span><span class="pun">,</span> <span class="pln">post</span><span class="pun">)</span>
             <span class="pun">}</span>
        <span class="pun">}</span>
    <span class="pun">}</span>
    <span class="kwd">return</span> <span class="pln">result</span>
<span class="pun">}</span>
</pre>

<p>Then, there are two tasks to implement:</p>

<p>ç„¶åï¼Œæœ‰ä¸¤ä¸ªä»»åŠ¡è¦å»å®ç°</p>

<ul>
<li>Tags Page æ ‡ç­¾é¡µ</li>
<li>List of Posts for a selected Tag å±•ç¤ºé€‰æ‹©çš„æ ‡ç­¾çš„æ–‡ç« å•Š
The data structure of a Tag looks like this:</li>
</ul>

<p>æ•°æ®ç»“æ„å¦‚ä¸‹</p>

<pre><span class="kwd">type</span> <span class="typ">Tag</span> <span class="kwd">struct</span> <span class="pun">{</span>
    <span class="typ">Name</span>  <span class="pln">string</span>
    <span class="typ">Link</span>  <span class="pln">string</span>
    <span class="typ">Count</span> <span class="kwd">int</span>
<span class="pun">}</span>
</pre>

<p>So, we have the actual tag (Name), the Link to the tagâ€™s listing page and the amount of posts with this tag. These tags are created from the tagPostsMap and then sorted by Count descending:</p>

<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ‰å®é™…çš„æ ‡ç­¾ï¼ˆåï¼‰ï¼Œæ ‡ç­¾åˆ—è¡¨é¡µçš„è¿æ¥å’Œè¿™ä¸ªæ ‡ç­¾çš„æ–‡ç« ã€‚è¿™äº›æ ‡ç­¾ç”±tagPostMapåˆ›å»ºï¼Œç„¶åæ ¹æ®æ•°ç›®é™åºæ’åˆ—ã€‚</p>

<pre><span class="pln">tags</span> <span class="pun">:</span><span class="pun">=</span> <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Tag</span><span class="pun">{</span><span class="pun">}</span>
<span class="kwd">for</span> <span class="pln">tag</span><span class="pun">,</span> <span class="pln">posts</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">tagPostsMap</span> <span class="pun">{</span>
    <span class="pln">tags</span> <span class="pun">=</span> <span class="kwd">append</span><span class="pun">(</span><span class="pln">tags</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="typ">Tag</span><span class="pun">{</span><span class="typ">Name</span><span class="pun">:</span> <span class="pln">tag</span><span class="pun">,</span> <span class="typ">Link</span><span class="pun">:</span> <span class="pln">getTagLink</span><span class="pun">(</span><span class="pln">tag</span><span class="pun">)</span><span class="pun">,</span> <span class="typ">Count</span><span class="pun">:</span> <span class="pln">len</span><span class="pun">(</span><span class="pln">posts</span><span class="pun">)</span><span class="pun">}</span><span class="pun">)</span>
<span class="pun">}</span>
<span class="pln">sort</span><span class="pun">.</span><span class="typ">Sort</span><span class="pun">(</span><span class="typ">ByCountDesc</span><span class="pun">(</span><span class="pln">tags</span><span class="pun">)</span><span class="pun">)</span>
</pre>

<p>The Tags Page basically just consists of this list rendered into the tags/index.html file.</p>

<p>æ ‡ç­¾é¡µä»…ä»…ç”±æ¸²æŸ“åˆ°tags/index.htmlçš„æ–‡ä»¶ç»„æˆ</p>

<p>The List of Posts for a selected Tag can be achieved using the ListingGenerator described above. We just need to iterate the tags, create a folder for each tag, select the posts to display and generate a listing for them.</p>

<p>é€‰æ‹©çš„æ ‡ç­¾çš„æ–‡ç« åˆ—è¡¨èƒ½è¢«å­˜æ¡£ï¼Œä½¿ç”¨ä¸Šé¢çš„ListingGeneratorã€‚æˆ‘ä»¬ä»…ä»…éœ€è¦è¿­ä»£æ ‡ç­¾ï¼Œç»™æ¯ä¸€ä¸ªæ ‡ç­¾åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œé€‰æ‹©é€‰æ‹©æ–‡ç« å±•ç¤ºå¹¶ç”Ÿæˆåˆ—è¡¨</p>

<h3>Sitemap &amp; RSS</h3>

<p>To improve searchability on the web, itâ€™s a good idea to have a sitemap.xml which can be crawled by bots. Creating such a file is fairly straightforward and can be done using the Go standard library.</p>

<p>ä¸ºäº†æé«˜ç½‘ç«™çš„æœç´¢èƒ½åŠ›ï¼Œæœ‰ä¸ªå¥½ä¸»æ„æ˜¯æ‹¥æœ‰ä¸€ä¸ªsitemap.xmlï¼Œå®ƒèƒ½å¤Ÿè¢«botsçˆ¬åˆ°ã€‚åˆ›å»ºè¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ç›¸å½“ç®€å•ï¼Œä½¿ç”¨Goçš„æ ‡å‡†åº“å°±å¯ä»¥äº†ã€‚</p>

<p>In this tool, however, I opted to use the great etree library, which provides a nice API for creating and reading XML.</p>

<p>ä½†æ˜¯åœ¨è¿™ä¸ªå·¥å…·é‡Œï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨<a href="https://github.com/beevik/etree">etree</a>åº“ï¼Œå®ƒæä¾›åˆ›å»ºä¸ªè¯»å–xmléå¸¸å¥½ç”¨çš„APIã€‚</p>

<p>The SitemapGenerator uses this config:</p>

<p>SitemapGeneratorä½¿ç”¨è¿™ä¸ªé…ç½®ï¼š</p>

<pre><span class="kwd">type</span> <span class="typ">SitemapConfig</span> <span class="kwd">struct</span> <span class="pun">{</span>
    <span class="typ">Posts</span>       <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span>
    <span class="typ">TagPostsMap</span> <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span>
    <span class="typ">Destination</span> <span class="pln">string</span>
<span class="pun">}</span>
</pre>

<p>blog-generator takes a basic approach to the sitemap and just generates url and image locations by using the addURL function:</p>

<p>blog-generatorå¯¹ç«™ç‚¹åœ°å›¾è¿›è¡Œäº†åŸºæœ¬çš„å¤„ç†ï¼Œå¹¶é€šè¿‡ä½¿ç”¨addURLå‡½æ•°ç”Ÿæˆurlå’Œå›¾åƒä½ç½®ã€‚</p>

<pre><span class="kwd">func</span> <span class="pln">addURL</span><span class="pun">(</span><span class="pln">element</span> <span class="pun">*</span><span class="pln">etree</span><span class="pun">.</span><span class="typ">Element</span><span class="pun">,</span> <span class="pln">location</span> <span class="pln">string</span><span class="pun">,</span> <span class="pln">images</span> <span class="pun">[</span><span class="pun">]</span><span class="pln">string</span><span class="pun">)</span> <span class="pun">{</span>
    <span class="pln">url</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">element</span><span class="pun">.</span><span class="typ">CreateElement</span><span class="pun">(</span><span class="str">&#34;url&#34;</span><span class="pun">)</span>
     <span class="pln">loc</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">url</span><span class="pun">.</span><span class="typ">CreateElement</span><span class="pun">(</span><span class="str">&#34;loc&#34;</span><span class="pun">)</span>
     <span class="pln">loc</span><span class="pun">.</span><span class="typ">SetText</span><span class="pun">(</span><span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/%s/&#34;</span><span class="pun">,</span> <span class="pln">blogURL</span><span class="pun">,</span> <span class="pln">location</span><span class="pun">)</span><span class="pun">)</span>

     <span class="kwd">if</span> <span class="pln">len</span><span class="pun">(</span><span class="pln">images</span><span class="pun">)</span> <span class="pun">&gt;</span> <span class="dec">0</span> <span class="pun">{</span>
         <span class="kwd">for</span> <span class="pln">_</span><span class="pun">,</span> <span class="pln">image</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">images</span> <span class="pun">{</span>
            <span class="pln">img</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">url</span><span class="pun">.</span><span class="typ">CreateElement</span><span class="pun">(</span><span class="str">&#34;image:image&#34;</span><span class="pun">)</span>
             <span class="pln">imgLoc</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">img</span><span class="pun">.</span><span class="typ">CreateElement</span><span class="pun">(</span><span class="str">&#34;image:loc&#34;</span><span class="pun">)</span>
             <span class="pln">imgLoc</span><span class="pun">.</span><span class="typ">SetText</span><span class="pun">(</span><span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/%s/images/%s&#34;</span><span class="pun">,</span> <span class="pln">blogURL</span><span class="pun">,</span> <span class="pln">location</span><span class="pun">,</span> <span class="pln">image</span><span class="pun">)</span><span class="pun">)</span>
         <span class="pun">}</span>
     <span class="pun">}</span>
<span class="pun">}</span>
</pre>

<p>After creating the XML document with etree, itâ€™s just saved to a file and stored in the output folder.</p>

<p>ä½¿ç”¨etreeåˆ›å»ºxmlæ–‡ä»¶ä¹‹åï¼Œä¿å­˜å¹¶å­˜å‚¨æ–‡ä»¶åˆ°æ–‡ä»¶å¤¹ä¸­ã€‚</p>

<p>RSS generation works the same way - iterate all posts and create XML entries for each post, then write to index.xml.</p>

<p>Rssç”Ÿæˆå™¨ä½¿ç”¨åŒæ ·çš„æ–¹æ³•ç”Ÿæˆ - éå†æ‰€æœ‰æ–‡ç« å¹¶ä¸ºæ¯ä¸ªpoståˆ›å»ºXMLæ¡ç›®ï¼Œç„¶åå°†å…¶å†™å…¥index.XMLã€‚</p>

<h3>Handling Statics</h3>

<p>The last concept I needed were entirely static assets like a favicon.ico or a static page like About. To do this, the tool runs the StaticsGenerator with this config:</p>

<p>æˆ‘æ‰€éœ€è¦çš„æœ€åä¸€ä¸ªæ¦‚å¿µæ˜¯å®Œå…¨é™æ€çš„èµ„æºï¼Œæ¯”å¦‚favicon.icoæˆ–é™æ€é¡µé¢ä¾‹å¦‚Aboutã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯¥å·¥å…·ä½¿ç”¨è¿™ä¸ªé…ç½®æ¥è¿è¡ŒStaticsGenerator:</p>

<pre><span class="kwd">type</span> <span class="typ">StaticsConfig</span> <span class="kwd">struct</span> <span class="pun">{</span>
    <span class="typ">FileToDestination</span> <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pln">string</span>
    <span class="typ">TemplateToFile</span>    <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pln">string</span>
    <span class="typ">Template</span>          <span class="pun">*</span><span class="kwd">template</span><span class="pun">.</span><span class="typ">Template</span>
<span class="pun">}</span>
</pre>

<p>The FileToDestination-map represents static files like images or the robots.txt and TemplateToFile is a mapping from templates in the static folder to their designated output path.</p>

<p>FileToDestination-mapè¡¨ç¤ºåƒå›¾ç‰‡æˆ–è€…robot.txtçš„é™æ€æ–‡ä»¶ï¼ŒTemplateToFilesæ˜¯ä»é™æ€æ–‡ä»¶å¤¹ä¸­çš„æ¨¡æ¿åˆ°æŒ‡å®šçš„è¾“å‡ºè·¯å¾„çš„æ˜ å°„ã€‚</p>

<p>This configuration could look like this in practice:</p>

<p>å®é™…ä¸Šï¼Œé…ç½®æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼š</p>

<pre><span class="pln">fileToDestination</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pln">string</span><span class="pun">{</span>
    <span class="str">&#34;static/favicon.ico&#34;</span><span class="pun">:</span> <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/favicon.ico&#34;</span><span class="pun">,</span> <span class="pln">destination</span><span class="pun">)</span><span class="pun">,</span>
    <span class="str">&#34;static/robots.txt&#34;</span><span class="pun">:</span>  <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/robots.txt&#34;</span><span class="pun">,</span> <span class="pln">destination</span><span class="pun">)</span><span class="pun">,</span>
    <span class="str">&#34;static/about.png&#34;</span><span class="pun">:</span>   <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/about.png&#34;</span><span class="pun">,</span> <span class="pln">destination</span><span class="pun">)</span><span class="pun">,</span>
<span class="pun">}</span>
<span class="pln">templateToFile</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">map</span><span class="pun">[</span><span class="pln">string</span><span class="pun">]</span><span class="pln">string</span><span class="pun">{</span>
    <span class="str">&#34;static/about.html&#34;</span><span class="pun">:</span> <span class="pln">fmt</span><span class="pun">.</span><span class="typ">Sprintf</span><span class="pun">(</span><span class="str">&#34;%s/about/index.html&#34;</span><span class="pun">,</span> <span class="pln">destination</span><span class="pun">)</span><span class="pun">,</span>
<span class="pun">}</span>
<span class="pln">statg</span> <span class="pun">:</span><span class="pun">=</span> <span class="typ">StaticsGenerator</span><span class="pun">{</span><span class="pun">&amp;</span><span class="typ">StaticsConfig</span><span class="pun">{</span>
<span class="typ">FileToDestination</span><span class="pun">:</span> <span class="pln">fileToDestination</span><span class="pun">,</span>
   <span class="typ">TemplateToFile</span><span class="pun">:</span>    <span class="pln">templateToFile</span><span class="pun">,</span>
   <span class="typ">Template</span><span class="pun">:</span>          <span class="pln">t</span><span class="pun">,</span>
<span class="pun">}</span><span class="pun">}</span>
</pre>

<p>The code for generating these statics is not particularly interesting - as you can imagine, the files are just iterated and copied to the given destination.</p>

<p>ç”Ÿæˆè¿™äº›é™æ€æ–‡ä»¶çš„ä»£ç ä¸æ˜¯å¾ˆæœ‰è¶£ - æ­£å¦‚ä½ æƒ³çš„é‚£æ ·ï¼Œä»…ä»…å°±æ˜¯éå†æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶åˆ°ç›®æ ‡åœ°ç‚¹</p>

<h3>Parallel Execution å¹¶è¡Œæ‰§è¡Œ</h3>

<p>For blog-generator to be fast, the generators are all run in parallel. For this purpose, they all follow the Generator interface - this way we can put them all inside a slice and concurrently call Generate for all of them.</p>

<p>ä¸ºäº†è®©blog-generatoræ›´å¿«ï¼Œç”Ÿæˆå™¨éƒ½å¹¶è¡Œè¿è¡Œã€‚ä¸ºäº†è¿™ä¸ªç›®çš„ï¼Œä»–ä»¬éƒ½éµå¾ªç€Generatorçš„æ¥å£ - è¿™æ ·æˆ‘å¯ä»¥å°†ä»–ä»¬æ”¾åœ¨ä¸€ä¸ªsliceä¸­ï¼Œå¹¶å‘çš„è°ƒç”¨ç”Ÿæˆå™¨ã€‚</p>

<p>The generators all work independently of one another and donâ€™t use any global state mutation, so parallelizing them was a simple exercise of using channels and a sync.WaitGroup like this:</p>

<p>ç”Ÿæˆå™¨è¿è¡Œéƒ½ç›¸äº’ç‹¬ç«‹ï¼Œä¸”ä¸ä½¿ç”¨ä»»ä½•å…¨å±€çŠ¶æ€å˜åŒ–ï¼Œæ‰€ä»¥å¹¶è¡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨channelå’Œsync.WaitGroupçš„ç»ƒä¹ ï¼Œå°±åƒè¿™æ ·ï¼š</p>

<pre><span class="kwd">func</span> <span class="pln">runTasks</span><span class="pun">(</span><span class="pln">posts</span> <span class="pun">[</span><span class="pun">]</span><span class="pun">*</span><span class="typ">Post</span><span class="pun">,</span> <span class="pln">t</span> <span class="pun">*</span><span class="kwd">template</span><span class="pun">.</span><span class="typ">Template</span><span class="pun">,</span> <span class="pln">destination</span> <span class="pln">string</span><span class="pun">)</span> <span class="pln">error</span> <span class="pun">{</span>
    <span class="kwd">var</span> <span class="pln">wg</span> <span class="pln">sync</span><span class="pun">.</span><span class="typ">WaitGroup</span>
    <span class="pln">finished</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">make</span><span class="pun">(</span><span class="pln">chan</span> <span class="kwd">bool</span><span class="pun">,</span> <span class="dec">1</span><span class="pun">)</span>
    <span class="pln">errors</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">make</span><span class="pun">(</span><span class="pln">chan</span> <span class="pln">error</span><span class="pun">,</span> <span class="dec">1</span><span class="pun">)</span>
    <span class="pln">pool</span> <span class="pun">:</span><span class="pun">=</span> <span class="kwd">make</span><span class="pun">(</span><span class="pln">chan</span> <span class="kwd">struct</span><span class="pun">{</span><span class="pun">}</span><span class="pun">,</span> <span class="dec">50</span><span class="pun">)</span>
    <span class="pln">generators</span> <span class="pun">:</span><span class="pun">=</span> <span class="pun">[</span><span class="pun">]</span><span class="typ">Generator</span><span class="pun">{</span><span class="pun">}</span>

    <span class="kwd">for</span> <span class="pln">_</span><span class="pun">,</span> <span class="pln">post</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">posts</span> <span class="pun">{</span>
        <span class="pln">pg</span> <span class="pun">:</span><span class="pun">=</span> <span class="typ">PostGenerator</span><span class="pun">{</span><span class="pun">&amp;</span><span class="typ">PostConfig</span><span class="pun">{</span>
            <span class="typ">Post</span><span class="pun">:</span>        <span class="pln">post</span><span class="pun">,</span>
             <span class="typ">Destination</span><span class="pun">:</span> <span class="pln">destination</span><span class="pun">,</span>
             <span class="typ">Template</span><span class="pun">:</span>    <span class="pln">t</span><span class="pun">,</span>
        <span class="pun">}</span><span class="pun">}</span>
        <span class="pln">generators</span> <span class="pun">=</span> <span class="kwd">append</span><span class="pun">(</span><span class="pln">generators</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">pg</span><span class="pun">)</span>
    <span class="pun">}</span>

    <span class="pln">fg</span> <span class="pun">:</span><span class="pun">=</span> <span class="typ">ListingGenerator</span><span class="pun">{</span><span class="pun">&amp;</span><span class="typ">ListingConfig</span><span class="pun">{</span>
        <span class="typ">Posts</span><span class="pun">:</span>       <span class="pln">posts</span><span class="pun">[</span><span class="pun">:</span><span class="pln">getNumOfPagesOnFrontpage</span><span class="pun">(</span><span class="pln">posts</span><span class="pun">)</span><span class="pun">]</span><span class="pun">,</span>
        <span class="typ">Template</span><span class="pun">:</span>    <span class="pln">t</span><span class="pun">,</span>
        <span class="typ">Destination</span><span class="pun">:</span> <span class="pln">destination</span><span class="pun">,</span>
        <span class="typ">PageTitle</span><span class="pun">:</span>   <span class="str">&#34;&#34;</span><span class="pun">,</span>
    <span class="pun">}</span><span class="pun">}</span>

    <span class="pun">.</span><span class="pun">.</span><span class="pun">.</span><span class="pln">create</span> <span class="pln">the</span> <span class="pln">other</span> <span class="pln">generators</span><span class="pun">.</span><span class="pun">.</span><span class="pun">.</span>

    <span class="pln">generators</span> <span class="pun">=</span> <span class="kwd">append</span><span class="pun">(</span><span class="pln">generators</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">fg</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">ag</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">tg</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">sg</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">rg</span><span class="pun">,</span> <span class="pun">&amp;</span><span class="pln">statg</span><span class="pun">)</span>

    <span class="kwd">for</span> <span class="pln">_</span><span class="pun">,</span> <span class="pln">generator</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">range</span> <span class="pln">generators</span> <span class="pun">{</span>
        <span class="pln">wg</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="dec">1</span><span class="pun">)</span>
        <span class="pln">go</span> <span class="kwd">func</span><span class="pun">(</span><span class="pln">g</span> <span class="typ">Generator</span><span class="pun">)</span> <span class="pun">{</span>
            <span class="pln">defer</span> <span class="pln">wg</span><span class="pun">.</span><span class="typ">Done</span><span class="pun">(</span><span class="pun">)</span>
            <span class="pln">pool</span> <span class="pun">&lt;</span><span class="pun">-</span> <span class="kwd">struct</span><span class="pun">{</span><span class="pun">}</span><span class="pun">{</span><span class="pun">}</span>
            <span class="pln">defer</span> <span class="kwd">func</span><span class="pun">(</span><span class="pun">)</span> <span class="pun">{</span> <span class="pun">&lt;</span><span class="pun">-</span><span class="pln">pool</span> <span class="pun">}</span><span class="pun">(</span><span class="pun">)</span>
            <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pln">g</span><span class="pun">.</span><span class="typ">Generate</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
                <span class="pln">errors</span> <span class="pun">&lt;</span><span class="pun">-</span> <span class="pln">err</span>
            <span class="pun">}</span>
        <span class="pun">}</span><span class="pun">(</span><span class="pln">generator</span><span class="pun">)</span>
    <span class="pun">}</span>

    <span class="pln">go</span> <span class="kwd">func</span><span class="pun">(</span><span class="pun">)</span> <span class="pun">{</span>
        <span class="pln">wg</span><span class="pun">.</span><span class="typ">Wait</span><span class="pun">(</span><span class="pun">)</span>
        <span class="pln">close</span><span class="pun">(</span><span class="pln">finished</span><span class="pun">)</span>
    <span class="pun">}</span><span class="pun">(</span><span class="pun">)</span>

    <span class="pln">select</span> <span class="pun">{</span>
    <span class="kwd">case</span> <span class="pun">&lt;</span><span class="pun">-</span><span class="pln">finished</span><span class="pun">:</span>
        <span class="kwd">return</span> <span class="kwd">nil</span>
    <span class="kwd">case</span> <span class="pln">err</span> <span class="pun">:</span><span class="pun">=</span> <span class="pun">&lt;</span><span class="pun">-</span><span class="pln">errors</span><span class="pun">:</span>
        <span class="kwd">if</span> <span class="pln">err</span> <span class="pun">!</span><span class="pun">=</span> <span class="kwd">nil</span> <span class="pun">{</span>
           <span class="kwd">return</span> <span class="pln">err</span>
        <span class="pun">}</span>
    <span class="pun">}</span>
    <span class="kwd">return</span> <span class="kwd">nil</span>
<span class="pun">}</span>
</pre>

<p>The runTasks function uses a pool of max. 50 goroutines, creates all generators, adds them to a slice and then runs them in parallel.</p>

<p>runTaskså‡½æ•°ä½¿ç”¨æœ€å¤§50åç¨‹çš„åç¨‹æ± ï¼Œåˆ›å»ºæ‰€æœ‰ç”Ÿæˆå™¨ï¼Œå°†ä»–ä»¬æ·»åŠ åˆ°sliceä¸­ï¼Œç„¶åå¹¶è¡Œè¿è¡Œä»–ä»¬</p>

<p>These examples were just a short dive into the basic concepts used to write a static-site generator in Go.</p>

<p>è¿™äº›ä¾‹å­ä»…ä»…åˆæ­¥æ·±å…¥åŸºæœ¬æ¦‚å¿µç”¨äºä½¿ç”¨Goå†™ä¸€ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨</p>

<p>If youâ€™re interested in the full implementation, you can find the code here.</p>

<p>å¦‚æœä½ å¯¹æ•´ä¸ªå®ç°æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥åœ¨<a href="https://github.com/zupzup/blog-generator">è¿™é‡Œ</a>æ‰¾åˆ°ä»£ç .</p>

<h2>Conclusion æ€»ç»“</h2>

<p>Writing my blog-generator was an absolute blast and a great learning experience. Itâ€™s also quite satisfying to use my own hand-crafted tool for creating my blog.</p>

<p>ç¼–å†™æˆ‘çš„åšå®¢ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç»å¯¹çš„æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„å­¦ä¹ ä½“éªŒã€‚ä½¿ç”¨æˆ‘è‡ªå·±çš„æ‰‹å·¥å·¥å…·åˆ›å»ºæˆ‘çš„åšå®¢ä¹Ÿå¾ˆä»¤äººæ»¡æ„ã€‚</p>

<p>To publish my posts to AWS, I also created static-aws-deploy, another Go command-line tool, which I covered in this post.</p>

<p>ä¸ºäº†å‘å¸ƒæˆ‘çš„æ–‡ç« åˆ°AWSï¼Œæˆ‘åŒæ ·åˆ›å»ºäº†<a href="https://github.com/zupzup/static-aws-deploy">static-aws-deploy</a>ï¼Œé¢å¤–çš„Goå‘½ä»¤è¡Œå·¥å…·ï¼Œæˆ‘åœ¨è¿™ç¯‡<a href="https://zupzup.org/static-deploy-tool/">æ–‡ç« </a>ä¸­ä¼šæåˆ°æåˆ°</p>

<p>If you want to use the tool yourself, just fork the repo and change the configuration. However, I didnâ€™t put much time into customizability or configurability, as Hugo provides all that and more.</p>

<p>å¦‚æœä½ æƒ³è‡ªå·±ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œä»…ä»…forkè¿™ä¸ªrepoï¼Œå¹¶ä¿®æ”¹é…ç½®å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œæˆ‘æ²¡æœ‰èŠ±å¤ªå¤šæ—¶é—´æ¥åšå¯å®šåˆ¶åŒ–å’Œå¯é…ç½®åŒ–ï¼Œå› ä¸º<a href="https://gohugo.io/">Hugo</a>æä¾›çš„äº†æ‰€æœ‰ä½ éœ€è¦çš„ã€‚</p>

<p>Of course, one should strive not to re-invent the wheel all the time, but sometimes re-inventing a wheel or two can be rewarding and can help you learn quite a bit in the process. :)</p>

<p>å½“ç„¶ï¼Œä¸€ä¸ªäººåº”è¯¥åŠªåŠ›ä¸å»é‡æ–°å‘æ˜è½®å­ï¼Œä½†æ˜¯æœ‰æ—¶å€™é‡æ–°å‘æ˜ä¸€ä¸¤ä¸ªè½®å­æ˜¯å€¼å¾—çš„ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚:)</p>

<h3>Resources</h3>

<ul>
<li><a href="https://github.com/zupzup/blog-generator">blog-generator on GitHub</a></li>
<li><a href="https://gohugo.io/">Hugo</a></li>
<li><a href="https://github.com/beevik/etree">etree</a></li>
</ul>
</div>
</body>

</html>